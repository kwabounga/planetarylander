<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Planetary lander</title>
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="shortcut icon" href="favicon.png" type="image/png" />

  </head>
  <body onload="init()">
    <!-- loader -->
    <div id="loader"><img id="loader-logo" class="rotating"src="./assets/iconkwa.png"></img></div>
    <!-- canvas -->
    <canvas id="game-canvas" width="800" height="600" style="display: none;"></canvas>

    <!---------->
    <!-- libs -->
    <!---------->
    
    <!-- pixi -->
    <script src="./lib/pixi.js"></script>

    <!-- svg stuffs -->
    <script src="./lib/pathseg.js"></script>
    <script src="./lib/decomp.min.js"></script>

    <!-- matter js -->
    <script src="./lib/matter.js"></script>
    
    <!-- gsap (tween) -->
    <script src="./lib/gsap.min.js"></script>
    <script src="./lib/PixiPlugin.min.js"></script>

    <!-- scripts -->
    <script src="./exports/State.js"></script> 
    <script src="./exports/tools/tools.js"></script>
    <script src="./exports/tools/Keyboard.js"></script>
    <script src="./exports/hud/Ui.js"></script>
    <script src="./exports/game/levels/Level.js"></script>
    <script src="./exports/game/landers/Flag.js"></script>
    <script src="./exports/game/landers/Stabilizer.js"></script>
    <script src="./exports/game/landers/Reactor.js"></script>
    <script src="./exports/game/landers/LanderBody.js"></script>
    <script src="./exports/game/levels/BonusSprite.js"></script>
    <script src="./exports/game/landers/Lander.js"></script>
    <script src="./exports/game/landers/Landers.js"></script>
    <script src="./exports/game/levels/Terrains.js"></script>
    <script src="./exports/menu/ButtonSprite.js"></script>
    <script src="./exports/menu/Button.js"></script>
    <script src="./exports/menu/MenuBg.js"></script>
    <script src="./exports/menu/Menu.js"></script>
    <script src="./exports/Main.js"></script>

    <script>
        function init(){


            let s = State.getInstance();
            // s.height = Tools.availableSize.height();
            // s.width = Tools.availableSize.width();   
            Tools.ajaxGet(`./data/main.json`, (mdata) => {
              let mData = JSON.parse(mdata);
              s.menuData = mData.menu;
              console.log(s)
              Tools.ajaxGet(`./data/${Tools.getHash()}.json`, (data) => {
                let d = JSON.parse(data);
                let main = new Main(d);
              });
            });
            // FOR DEBUG ONLY
            // TODO: Access to the Menu then loading levels etc.  
            
            // console.log(Tools.dataLoader.data);
            Tools.dataLoader.add('main','./data/main.json');
            // Tools.dataLoader.add('moon','./data/moon.json');
            // // Tools.dataLoader.add('error','./data/thisfiledoesnotexist.json'); // error not found here
            Tools.dataLoader.once((data)=>{
              console.log(data); // get the data
              console.log(Tools.dataLoader.data); // access direct to the data
              Tools.dataLoader.clean() // clean up 
              console.log(Tools.dataLoader.data); // empty data
            })
            Tools.dataLoader.load()
            
        }

    </script>
  </body>
</html>
